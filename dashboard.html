<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Sleep & Productivity Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #1a2b3c;
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 340px;
            background: #f5f5f5;
            padding: 30px 20px;
            display: flex;
            flex-direction: column;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 40px;
            padding: 0 10px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #5b7fd4;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .logo-text {
            font-size: 16px;
            font-weight: 600;
            color: #1a2b3c;
        }

        .nav-menu {
            list-style: none;
            flex: 1;
        }

        .nav-item {
            margin-bottom: 8px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 16px;
            border-radius: 10px;
            text-decoration: none;
            color: #666;
            font-weight: 500;
            transition: all 0.3s;
            cursor: pointer;
        }

        .nav-link:hover {
            background: #e8eef7;
            color: #5b7fd4;
        }

        .nav-link.active {
            background: #d4e3f7;
            color: #5b7fd4;
        }

        .nav-icon {
            font-size: 20px;
            width: 24px;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            border-top: 1px solid #ddd;
            margin-top: auto;
            cursor: pointer;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #5b7fd4;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .user-info {
            flex: 1;
        }

        .user-name {
            font-weight: 600;
            color: #1a2b3c;
            font-size: 14px;
        }

        .user-role {
            font-size: 12px;
            color: #999;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
        }

        .page-title {
            font-size: 36px;
            font-weight: 700;
            color: white;
            margin-bottom: 30px;
        }

        .content-grid {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 28px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .card-title {
            font-size: 20px;
            font-weight: 700;
            color: #1a2b3c;
            margin-bottom: 20px;
        }

        /* Daily Input */
        .input-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
            display: block;
        }

        .input-wrapper {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }

        .sleep-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            outline: none;
        }

        .sleep-input:focus {
            border-color: #5b7fd4;
        }

        .submit-btn {
            background: #5b7fd4;
            color: white;
            border: none;
            padding: 12px 32px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .submit-btn:hover {
            background: #4a6bc3;
            transform: translateY(-1px);
        }

        /* Results Table */
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .results-table th {
            background: #f8f9fa;
            padding: 12px;
            text-align: left;
            font-size: 13px;
            font-weight: 600;
            color: #1a2b3c;
            border-bottom: 2px solid #e0e0e0;
        }

        .results-table td {
            padding: 16px 12px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 14px;
            color: #333;
            vertical-align: middle; /* ADDED: To align buttons nicely */
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-high {
            background: #d4edda;
            color: #28a745;
        }

        .badge-medium {
            background: #fff3cd;
            color: #856404;
        }

        .badge-low {
            background: #f8d7da;
            color: #dc3545;
        }

        .action-btn {
            padding: 6px 12px;
            font-size: 12px;
            border: 1px solid #ddd;
            background: #f8f9fa;
            border-radius: 6px;
            cursor: pointer;
            margin-right: 4px;
        }
        .action-btn:hover {
            background: #e9ecef;
        }
        .action-btn.delete {
            color: #dc3545;
        }
        .action-btn.delete:hover {
            background: #f8d7da;
            border-color: #f5c6cb;
        }

        /* Recommendations */
        .recommendation-card {
            background: #d4e3f7;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
        }

        .rec-title {
            font-weight: 700;
            color: #1a2b3c;
            margin-bottom: 12px;
            font-size: 15px;
        }

        .rec-text {
            color: #333;
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 8px;
        }

        .rec-action {
            color: #5b7fd4;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
        }

        .recommendation-card.warning {
            background: #fff8e1;
        }

        /* Charts Section */
        .charts-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .chart-container {
            height: 240px;
            margin-top: 20px;
        }

        .chart-subtitle {
            font-size: 13px;
            color: #999;
            margin-bottom: 16px;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: #fefefe;
            padding: 24px;
            border: 1px solid #888;
            width: 90%;
            max-width: 400px;
            border-radius: 12px;
            text-align: center;
        }
        .modal-content h3 {
            margin-bottom: 16px;
        }
        .modal-content p {
            margin-bottom: 20px;
            color: #666;
        }
        .modal-content label {
            display: block;
            margin-bottom: 8px;
            text-align: left;
            font-weight: 600;
            color: #333;
        }
        .modal-content input {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 6px;
        }
        .modal-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
        }
        .modal-buttons button {
            padding: 10px 24px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
        }
        .modal-btn-primary {
            background-color: #5b7fd4;
            color: white;
        }
        .modal-btn-secondary {
            background-color: #f0f0f0;
            color: #333;
        }
        .modal-btn-danger {
            background-color: #dc3545;
            color: white;
        }


        @media (max-width: 1200px) {
            .sidebar {
                width: 280px;
            }

            .content-grid {
                grid-template-columns: 1fr;
            }

            .charts-row {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            body {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
            }

            .main-content {
                padding: 20px;
            }

            .chart-container {
                height: 240px;
                margin-top: 20px;
                position: relative;
            }

            .chart-container canvas {
                width: 100% !important;
                height: 100% !important;
            }
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="logo">
            <div class="logo-icon">🌙</div>
            <div class="logo-text">Sleep & Productivity Tracker</div>
        </div>

        <ul class="nav-menu">
            <li class="nav-item">
                <a class="nav-link active">
                    <span class="nav-icon">📊</span>
                    Dashboard
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="sleep-analysis.html">
                    <span class="nav-icon">🌙</span>
                    Sleep Analysis
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="recommendations.html">
                    <span class="nav-icon">💡</span>
                    Recommendations
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="settings.html">
                    <span class="nav-icon">⚙️</span>
                    Settings
                </a>
            </li>
        </ul>

        <div class="user-profile" onclick="window.location.href='profile.html'">
            <div class="user-avatar">👤</div>
            <div class="user-info">
                <div class="user-name" id="profileName">Username</div>
                <div class="user-role">Profile</div>
            </div>
        </div>
    </div>

    <div class="main-content">
        <h1 class="page-title">Dashboard</h1>

        <div class="content-grid">
            <div>
                <div class="card">
                    <h2 class="card-title">Daily Input</h2>
                    <label class="input-label">Sleep hours</label>
                    <div class="input-wrapper">
                        <input type="number" class="sleep-input" id="sleepHours" placeholder="e.g., 7.5" step="0.5" min="0" max="24">
                        <button class="submit-btn" onclick="logSleep()">Submit</button>
                    </div>
                </div>

                <div class="card" style="margin-top: 20px;">
                    <h2 class="card-title">Results</h2>
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th>Day</th>
                                <th>Sleep Hours</th>
                                <th>Energy</th>
                                <th>Focus</th>
                                <th>Productivity</th>
                                <th>Actions</th> </tr>
                        </thead>
                        <tbody id="resultsTable">
                            <tr>
                                <td colspan="6" style="text-align: center; color: #999; padding: 30px;"> No data yet. Log your first sleep entry!
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">Recommendations</h2>
                <div class="rec-action" style="cursor: pointer;"></div>
                <div id="recommendationsContainer">
                    <div class="recommendation-card">
                        <div class="rec-title">Start tracking your sleep!</div>
                        <p class="rec-text">Enter your sleep hours to get personalized recommendations and insights.</p>
                        <div class="rec-action">Get started →</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="charts-row">
        <div class="card">
            <h2 class="card-title">Metrics Over Time</h2>
            <div class="chart-container">
                <canvas id="metricsChart" width="400" height="200"></canvas>
            </div>
        </div>

        <div class="card">
            <h2 class="card-title">Sleep Duration</h2>
            <p class="chart-subtitle">Last 7 Days</p>
            <div class="chart-container">
                <canvas id="sleepChart" width="400" height="200"></canvas>
            </div>
        </div>
    </div>
</div> <div id="editModal" class="modal">
        <div class="modal-content">
            <h3>Edit Sleep Entry</h3>
            <label for="editSleepHours">Sleep hours:</label>
            <input type="number" id="editSleepHours" step="0.5" min="0" max="24">
            <div class="modal-buttons">
                <button class="modal-btn-secondary" onclick="closeModal()">Cancel</button>
                <button class="modal-btn-primary" onclick="saveEdit()">Save Changes</button>
            </div>
        </div>
    </div>

    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <h3>Confirm Deletion</h3>
            <p>Are you sure you want to delete this entry? This action cannot be undone.</p>
            <div class="modal-buttons">
                <button class="modal-btn-secondary" onclick="closeModal()">Cancel</button>
                <button class="modal-btn-danger" onclick="confirmDelete()">Delete</button>
            </div>
        </div>
    </div>


    <script>
const state = {
  energy: 70,
  focus: 60,
  sleepDebt: 0,
  history: []
};


let activeEntryId = null; 

function loadState() {
  const saved = localStorage.getItem('sleepTrackerState');
  if (saved) {
    const parsed = JSON.parse(saved);
    Object.assign(state, parsed);
  }

  const profile = localStorage.getItem('sleepTrackerProfile');
  if (profile) {
    const profileData = JSON.parse(profile);
    document.getElementById('profileName').textContent =
      profileData.name || 'Username';
  }

  updateDisplay();
}

function saveState() {
  localStorage.setItem('sleepTrackerState', JSON.stringify(state));
}

function calculateEnergy(sleepHours, prevEnergy, sleepDebt) {
  let energyEffect = 0;
  if (sleepHours <= 4) energyEffect = -25 + sleepHours * 5;
  else if (sleepHours <= 6) energyEffect = -5 + (sleepHours - 4) * 10;
  else if (sleepHours <= 8) energyEffect = 15 + (sleepHours - 6) * 15;
  else energyEffect = 45 + (sleepHours - 8) * 5;

  const sleepDebtPenalty = Math.min(30, sleepDebt * 3);
  const newEnergy = prevEnergy + energyEffect - sleepDebtPenalty;
  return Math.min(100, Math.max(20, newEnergy));
}

function calculateFocus(sleepHours, energy) {
  let factor = sleepHours >= 7 ? 0.85 : sleepHours >= 5 ? 0.7 : 0.5;
  const focus = energy * factor;
  return Math.min(100, Math.max(15, focus));
}

function getPerformanceLabel(v) {
  if (v >= 80) return 'Excellent';
  if (v >= 65) return 'Good';
  if (v >= 50) return 'Fair';
  return 'Poor';
}

function getBadgeClass(v) {
  if (v >= 70) return 'badge-high';
  if (v >= 50) return 'badge-medium';
  return 'badge-low';
}

function getBadgeText(v) {
  if (v >= 70) return 'High';
  if (v >= 50) return 'Medium';
  return 'Low';
}

function logSleep() {
  const sleepHoursInput = document.getElementById('sleepHours');
  const sleepHours = parseFloat(sleepHoursInput.value);
  if (isNaN(sleepHours) || sleepHours < 0 || sleepHours > 24) {
    alert('Please enter a valid number of hours (0–24)');
    return;
  }

  const newEntry = {
    id: new Date().getTime(), 
    date: new Date().toLocaleDateString(),
    day: `Day ${state.history.length + 1}`, 
    hours: sleepHours,
    energy: 0, 
    focus: 0,  
    performance: 'Poor', 
    productivity: 0 
  };

  state.history.unshift(newEntry);
  if (state.history.length > 7) state.history.pop();
  
  recalculateStateFromHistory(); 
  saveState();
  updateDisplay();
  sleepHoursInput.value = '';
}

function saveEdit() {
  const newHoursInput = document.getElementById('editSleepHours');
  const newHours = parseFloat(newHoursInput.value);
  if (isNaN(newHours) || newHours < 0 || newHours > 24) {
    alert('Please enter a valid number of hours (0-24).');
    return;
  }

  const entry = state.history.find(e => e.id === activeEntryId);
  if (entry) {
    entry.hours = newHours;
    recalculateStateFromHistory(); 
    saveState();
    updateDisplay();
  }
  closeModal();
}

function confirmDelete() {
  state.history = state.history.filter(e => e.id !== activeEntryId);
  recalculateStateFromHistory(); 
  saveState();
  updateDisplay();
  closeModal();
}

function recalculateStateFromHistory() {
  const reversedHistory = state.history.slice().reverse();
  let lastDayState = { energy: 70, focus: 60, sleepDebt: 0 };
  let dayCounter = 1;

  for (const entry of reversedHistory) {
    const sleepHours = entry.hours;
    const newEnergy = calculateEnergy(sleepHours, lastDayState.energy, lastDayState.sleepDebt);
    const newFocus = calculateFocus(sleepHours, newEnergy);
    
    const sleepDeficit = Math.max(0, 7.5 - sleepHours); 
    const recovery = (sleepHours >= 7.5) ? 1.5 : (sleepHours >= 6) ? 1 : 0.5;
    const newSleepDebt = Math.max(0, lastDayState.sleepDebt + sleepDeficit - recovery);

    entry.day = `Day ${dayCounter++}`; 
    entry.energy = Math.round(newEnergy);
    entry.focus = Math.round(newFocus);
    entry.productivity = Math.round((newEnergy + newFocus) / 2);
    
    entry.performance = getPerformanceLabel(entry.energy); 

    lastDayState = { energy: entry.energy, focus: entry.focus, sleepDebt: newSleepDebt };
  }

  state.energy = (state.history.length > 0) ? lastDayState.energy : 70;
  state.focus = (state.history.length > 0) ? lastDayState.focus : 60;
  state.sleepDebt = (state.history.length > 0) ? lastDayState.sleepDebt : 0;
}

function updateDisplay() {
  const tbody = document.getElementById('resultsTable');
  if (state.history.length === 0) {
    tbody.innerHTML = `
      <tr>
        <td colspan="6" style="text-align:center;color:#999;padding:30px;">
          No data yet. Log your first sleep entry!
        </td>
      </tr>`;
  } else {
    tbody.innerHTML = state.history
      .map(
        e => `
      <tr>
        <td><strong>${e.day}</strong></td>
        <td>${e.hours}h</td>
        <td><span class="badge ${getBadgeClass(e.energy)}">${getBadgeText(
          e.energy
        )}</span></td>
        <td><span class="badge ${getBadgeClass(e.focus)}">${getBadgeText(
          e.focus
        )}</span></td>
        <td><span class="badge ${getBadgeClass(e.productivity)}">${getBadgeText(
          e.productivity
        )}</span></td>
        <td>
            <button class="action-btn" onclick="openEditModal(${e.id})">Edit</button>
            <button class="action-btn delete" onclick="openDeleteModal(${e.id})">Delete</button>
        </td>
      </tr>`
      )
      .join('');
  }

  updateRecommendations();
  updateCharts();
}

function updateRecommendations() {
  const container = document.getElementById('recommendationsContainer');
  if (state.history.length === 0) {
    container.innerHTML = `
      <div class="recommendation-card">
        <div class="rec-title">Start tracking your sleep!</div>
        <p class="rec-text">Enter your sleep hours to get personalized recommendations and insights.</p>
        <div class="rec-action" style="cursor:pointer;">Get started →</div>
      </div>`;
    return;
  }

  const avg =
    state.history.reduce((s, d) => s + d.hours, 0) / state.history.length;
  const variance =
    Math.max(...state.history.map(d => d.hours)) -
    Math.min(...state.history.map(d => d.hours));

  let title = '';
  let msg = '';

  if (avg < 6) {
    title = "You're not getting enough sleep 😴";
    msg = `Your average sleep is ${avg.toFixed(
      1
    )} hours. Try to rest at least 7–8 hours nightly.`;
  } else if (avg >= 6 && avg < 8) {
    title = 'Almost there!';
    msg = `You're sleeping an average of ${avg.toFixed(
      1
    )} hours. Try reaching a consistent 8 hours.`;
  } else if (avg >= 8 && avg <= 9) {
    title = 'Great job maintaining healthy sleep! 🌙';
    msg = `You average ${avg.toFixed(
      1
    )} hours per night — keep it consistent!`;
  } else {
    title = 'You might be oversleeping 💤';
    msg = `Your average is ${avg.toFixed(
      1
    )} hours. Too much sleep can also affect productivity.`;
  }

  if (variance > 2)
    msg += ' Your sleep duration also varies — aim for more consistency.';

  container.innerHTML = `
    <div class="recommendation-card">
      <div class="rec-title">${title}</div>
      <p class="rec-text">${msg}</p>
      <div class="rec-action" style="cursor:pointer;" onclick="window.location.href='recommendations.html'">View tips →</div>
    </div>`;
}

function openEditModal(id) {
  const entry = state.history.find(e => e.id === id);
  if (entry) {
    activeEntryId = id;
    document.getElementById('editSleepHours').value = entry.hours;
    document.getElementById('editModal').style.display = 'flex';
  }
}

function openDeleteModal(id) {
  activeEntryId = id;
  document.getElementById('deleteModal').style.display = 'flex';
}

function closeModal() {
  document.getElementById('editModal').style.display = 'none';
  document.getElementById('deleteModal').style.display = 'none';
  activeEntryId = null;
}

function updateMetricsChart() {
  const canvas = document.getElementById('metricsChart');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const data = (state.history.slice().reverse().slice(-7)) || [];

  ctx.clearRect(0, 0, canvas.width, canvas.height);
  if (data.length === 0) {
    ctx.fillStyle = '#666';
    ctx.font = '14px Arial';
    ctx.textAlign = 'center';
    ctx.fillText('Log sleep data to see charts', canvas.width / 1.7, canvas.height / 1.7);
    return;
  }

  const padding = 40;
  const w = canvas.width - padding * 2;
  const h = canvas.height - padding * 2;
  
  if (data.length === 1) {
      data.push(data[0]); 
  }

  const points = data.map((d, i) => ({
    x: padding + (w / (data.length - 1)) * i,
    y: padding + h - ((d.productivity || 0) / 100) * h
  }));

  const grad = ctx.createLinearGradient(0, padding, 0, canvas.height);
  grad.addColorStop(0, 'rgba(255,206,86,0.6)');
  grad.addColorStop(1, 'rgba(255,206,86,0)');

  ctx.beginPath();
  if (points.length > 0) {
    ctx.moveTo(points[0].x, points[0].y);
    for (let i = 1; i < points.length; i++) {
        const prev = points[i - 1];
        const curr = points[i];
        const cx = (prev.x + curr.x) / 2;
        ctx.quadraticCurveTo(prev.x, prev.y, cx, (prev.y + curr.y) / 2);
    }
    
    if (points.length > 1) {
        ctx.lineTo(points[points.length - 1].x, points[points.length - 1].y);
    }
    
    ctx.lineTo(points[points.length - 1].x, canvas.height - padding);
    ctx.lineTo(points[0].x, canvas.height - padding);
  }
  ctx.closePath();

  ctx.fillStyle = grad;
  ctx.fill();

  ctx.beginPath();
  if (points.length > 0) {
    ctx.moveTo(points[0].x, points[0].y);
    for (let i = 1; i < points.length; i++) {
        const prev = points[i - 1];
        const curr = points[i];
        const cx = (prev.x + curr.x) / 2;
        ctx.quadraticCurveTo(prev.x, prev.y, cx, (prev.y + curr.y) / 2);
    }
    if (points.length > 1) {
       ctx.lineTo(points[points.length - 1].x, points[points.length - 1].y);
    }
  }
  ctx.strokeStyle = '#FFB300';
  ctx.lineWidth = 3;
  ctx.stroke();

  ctx.fillStyle = '#999';
  ctx.font = '12px Arial';
  ctx.textAlign = 'right';
  for (let i = 0; i <= 4; i++) {
    const y = padding + (h / 4) * i;
    ctx.fillText(`${100 - i * 25}%`, padding - 10, y + 4);
  }

  ctx.textAlign = 'center';
  const xLabels = data.map(d => d.day);
  xLabels.forEach((d, i) => {
    const x = padding + (w / (xLabels.length - 1)) * i;
    ctx.fillText(d, x, canvas.height - 10);
  });
}

function updateSleepChart() {
  const canvas = document.getElementById('sleepChart');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const data = state.history.slice().reverse().slice(-7);

  ctx.clearRect(0, 0, canvas.width, canvas.height);
  if (data.length === 0) {
    ctx.fillStyle = '#666';
    ctx.font = '14px Arial';
    ctx.textAlign = 'center';
    ctx.fillText('No data to display', canvas.width / 1.7, canvas.height / 2.5);
    return;
  }

  const padding = 40;
  const w = canvas.width - padding * 2;
  const h = canvas.height - padding * 2;
  const barW = (w / data.length) * 0.7;
  const max = Math.max(...data.map(d => d.hours), 10);

  data.forEach((d, i) => {
    const x = padding + (w / data.length) * i + (w / data.length - barW) / 2;
    const barH = (d.hours / max) * h;
    const y = padding + h - barH;

    let color =
      d.hours >= 8 ? '#4ade80' :
      d.hours >= 7 ? '#60a5fa' :
      d.hours >= 6 ? '#f59e0b' : '#ef4444';

    ctx.fillStyle = color;
    ctx.fillRect(x, y, barW, barH);

    ctx.fillStyle = '#333';
    ctx.font = '12px Arial';
    ctx.textAlign = 'center';
    ctx.fillText(d.hours + 'h', x + barW / 2, y - 5);

    ctx.fillStyle = '#999';
    ctx.fillText(d.day, x + barW / 2, canvas.height - padding + 20);
  });
}

function updateCharts() {
  updateMetricsChart();
  updateSleepChart();
}

document.getElementById('sleepHours').addEventListener('keypress', e => {
  if (e.key === 'Enter') logSleep();
});

loadState();
</script>

</body>
</html>
